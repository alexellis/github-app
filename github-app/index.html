<html>
<head>
</head>
<body>
    <h2>Create your OpenFaaS Cloud GitHub App</h2>
    <form action="https://github.com/settings/apps/new" method="post">
        <p>Webhook URL i.e. https://system.example.com/github-event<br/>
            <input type="text" size="80" onchange="webhookChanged()" id="webhookURL" value="https://system.example.com/github-event"></input>
        </p>

        <p>
            Preview of your app manifest<br/>
            <textarea rows="10" cols="80" name="manifest" id="manifest"></textarea>
            <br>
            <input type="submit" value="Submit App">
        </p>
        </form>
        
        <script>

        function webhookChanged() {
            input = document.getElementById("manifest")
            webhookURL = document.getElementById("webhookURL")

            input.value = JSON.stringify({
                "name": "My OpenFaaS Cloud",
                "url": "https://github.com/openfaas/openfaas-cloud/",
                "hook_attributes": {
                    "url": webhookURL.value,
                },
                "redirect_url": webhookURL.value,
                "public": true,
                "default_permissions": {
                    "checks": "write",
                    "contents": "read",
                    "statuses": "write"
                },
                "default_events": [
                    "push",
                    "repository",
                ]
            })
        }

        webhookChanged();
        </script>
</body>
</html>
